<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thông Tin Chủ Hụi</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2c3e50;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
            color: #333;
        }
        
        .header {
            background-color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .card {
            border: none;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            margin-bottom: 20px;
        }
        
        .card-header {
            background-color: var(--primary-color);
            color: white;
            border-radius: 10px 10px 0 0 !important;
            padding: 15px 20px;
            font-weight: 600;
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            border: none;
        }
        
        .btn-primary:hover {
            background-color: #2980b9;
        }
        
        .back-btn {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 500;
        }
        
        .back-btn:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="container mt-4">
        <a href="dashboard.html" class="back-btn mb-3 d-inline-block">
            <i class="fas fa-arrow-left"></i> Quay lại Dashboard
        </a>
        
        <div class="header">
            <h2><i class="fas fa-user-tie"></i> Thông Tin Chủ Hụi</h2>
            <button class="btn btn-primary" id="editBtn">
                <i class="fas fa-edit"></i> Chỉnh sửa
            </button>
        </div>
        
        <div class="row">
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header">
                        Thông tin cơ bản
                    </div>
                    <div class="card-body">
                        <form id="chuhuiForm">
                            <div class="mb-3">
                                <label for="tenChuHui" class="form-label">Tên chủ hụi</label>
                                <input type="text" class="form-control" id="tenChuHui" value="Nguyễn Văn Chủ" readonly>
                            </div>
                            <div class="mb-3">
                                <label for="tenChuTK" class="form-label">Tên chủ tài khoản</label>
                                <input type="text" class="form-control" id="tenChuTK" value="Nguyễn Văn Chủ" readonly>
                            </div>
                            <div class="mb-3">
                                <label for="soDienThoai" class="form-label">Số điện thoại</label>
                                <input type="text" class="form-control" id="soDienThoai" value="0909123456" readonly>
                            </div>
                            <div class="mb-3">
                                <label for="tenNganHang" class="form-label">Tên ngân hàng</label>
                                <input type="text" class="form-control" id="tenNganHang" value="Vietcombank" readonly>
                            </div>
                            <div class="mb-3">
                                <label for="soTaiKhoan" class="form-label">Số tài khoản</label>
                                <input type="text" class="form-control" id="soTaiKhoan" value="123456789012" readonly>
                            </div>
                            <button type="submit" class="btn btn-primary d-none" id="saveBtn">Lưu thay đổi</button>
                            <button type="button" class="btn btn-secondary d-none" id="cancelBtn">Hủy</button>
                        </form>
                    </div>
                </div>
            </div>
            
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        Thống kê
                    </div>
                    <div class="card-body">
                        <div class="d-flex justify-content-between mb-3">
                            <span>Tổng dây hụi quản lý:</span>
                            <strong>5</strong>
                        </div>
                        <div class="d-flex justify-content-between mb-3">
                            <span>Tổng hội viên:</span>
                            <strong>42</strong>
                        </div>
                        <div class="d-flex justify-content-between mb-3">
                            <span>Tổng tiền hụi:</span>
                            <strong>125.000.000đ</strong>
                        </div>
                        <div class="d-flex justify-content-between">
                            <span>Hụi đang hoạt động:</span>
                            <strong>3</strong>
                        </div>
                    </div>
                </div>
                
                <div class="card mt-4">
                    <div class="card-header">
                        Lịch sử thay đổi
                    </div>
                    <div class="card-body">
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                <div>
                                    <small>Cập nhật thông tin</small>
                                    <div><small class="text-muted">15/06/2023</small></div>
                                </div>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                <div>
                                    <small>Thay đổi số tài khoản</small>
                                    <div><small class="text-muted">10/05/2023</small></div>
                                </div>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                <div>
                                    <small>Cập nhật thông tin</small>
                                    <div><small class="text-muted">20/03/2023</small></div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Khởi tạo Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyCYV8na-Az2LAgpl6QM2Tiwr6Gm9yhXQZ0",
            authDomain: "quan-ly-hui-8ad1c.firebaseapp.com",
            databaseURL: "https://quan-ly-hui-8ad1c-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "quan-ly-hui-8ad1c",
            storageBucket: "quan-ly-hui-8ad1c.firebasestorage.app",
            messagingSenderId: "665511229865",
            appId: "1:665511229865:web:fe44f814fff618e35e6cb8"
        };
        
        // Khởi tạo Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        
        // Xử lý chỉnh sửa thông tin
        document.getElementById('editBtn').addEventListener('click', function() {
            const inputs = document.querySelectorAll('#chuhuiForm input');
            inputs.forEach(input => {
                input.removeAttribute('readonly');
            });
            
            document.getElementById('saveBtn').classList.remove('d-none');
            document.getElementById('cancelBtn').classList.remove('d-none');
            this.classList.add('d-none');
        });
        
        document.getElementById('cancelBtn').addEventListener('click', function() {
            const inputs = document.querySelectorAll('#chuhuiForm input');
            inputs.forEach(input => {
                input.setAttribute('readonly', true);
            });
            
            document.getElementById('saveBtn').classList.add('d-none');
            this.classList.add('d-none');
            document.getElementById('editBtn').classList.remove('d-none');
            
            // Khôi phục giá trị từ Firebase
            loadChuHuiData();
        });
        
        document.getElementById('chuhuiForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Lấy dữ liệu từ form
            const chuhuiData = {
                tenChuHui: document.getElementById('tenChuHui').value,
                tenChuTK: document.getElementById('tenChuTK').value,
                soDienThoai: document.getElementById('soDienThoai').value,
                tenNganHang: document.getElementById('tenNganHang').value,
                soTaiKhoan: document.getElementById('soTaiKhoan').value
            };
            
            // Lưu dữ liệu lên Firebase
            database.ref('chuhui').set(chuhuiData)
                .then(() => {
                    alert('Thông tin chủ hụi đã được cập nhật thành công!');
                    
                    // Khóa form lại
                    const inputs = document.querySelectorAll('#chuhuiForm input');
                    inputs.forEach(input => {
                        input.setAttribute('readonly', true);
                    });
                    
                    document.getElementById('saveBtn').classList.add('d-none');
                    document.getElementById('cancelBtn').classList.add('d-none');
                    document.getElementById('editBtn').classList.remove('d-none');
                })
                .catch(error => {
                    console.error('Lỗi khi lưu thông tin chủ hụi:', error);
                    alert('Có lỗi xảy ra khi lưu thông tin. Vui lòng thử lại!');
                });
        });
        
        // Tải dữ liệu chủ hụi từ Firebase
        function loadChuHuiData() {
            database.ref('chuhui').once('value').then(snapshot => {
                const data = snapshot.val();
                if (data) {
                    document.getElementById('tenChuHui').value = data.tenChuHui || '';
                    document.getElementById('tenChuTK').value = data.tenChuTK || '';
                    document.getElementById('soDienThoai').value = data.soDienThoai || '';
                    document.getElementById('tenNganHang').value = data.tenNganHang || '';
                    document.getElementById('soTaiKhoan').value = data.soTaiKhoan || '';
                }
            });
        }
        
        // Gọi hàm tải dữ liệu khi trang được tải
        window.addEventListener('DOMContentLoaded', loadChuHuiData);
    </script>
</body>
</html>